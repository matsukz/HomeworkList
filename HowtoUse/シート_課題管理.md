# 課題管理シート
## 全体図
![Management_1](img/Management_1.png)

## 構成要素の解説
### 課題管理テーブル
#### 概要
* 基本的にはPowerQueryを用いてテーブルのデータを取得している
    * PowerQueryについて
        * [UsePowerQuery](UsePowerQuery.md)
    * 各セルの値や色は[シート_各科目](シート_各科目.md)の値を利用

* 上図はテーブルの機能である`フィルター`を利用して`期日`から`受付終了`のレコードを非表示にしている

#### セルの色について
##### 納期
![Kamoku_2](img/Kamoku_2.png)
|場合|条件式|フォントの色|塗りつぶしの色|
|:---:|:---:|:---:|:---:|
|期日経過後|セルの値 次より小さい =$I$1|#9C0006|#FFC7CE|
|今日|セルの値 次の値に等しい =$I$1|自動 （#000000）|#92D050|
|余裕あり|セルの値 次の値より大きい =$I$1|自動 （#000000）|#FFC000|

##### 期日
![Kadai_3](img\Kamoku_3.png)
|場合|条件式|フォントの色|塗りつぶしの色|
|:---:|:---:|:---:|:---:|
|受付終了|セルの値 次の値に等しい ="受付終了"|#9C0006|#FFC7CE|
|今日|特定の文字列 次の値を含む 今日|自動 （#000000）|#92D050|
|あとX日|特定の文字列 次の値を含む あと*日|自動 （#000000）|#FFC000|


##### 提出状況・進捗状況
![Kamoku_4](img/kamoku_4.png)
![kamoku_5](img/kamoku_5.png)
|場合|条件式|フォントの色|塗りつぶしの色|
|:---:|:---:|:---:|:---:|
|未完成|セルの値 次の値に等しい ="未完成"|#9C0006|#FFC7CE|
|未提出|セルの値 次の値に等しい ="未提出"|#9C0006|#FFC7CE|
|完成| セルの値 次の値に等しい ="完成"|自動 （#000000）|#92D050|
|提出済| セルの値 次の値に等しい ="提出済"|自動 （#000000）|#92D050|

### H1
#### 概要
* 本日の日付を表示
    ```
    =TODAY()
    ```
    特にこだわりはない
#### 補足
* 書式を`長い日付形式`に変更

### 命名規則
* 科目名を表示

### クエリ更新ボタン
#### 概要
* 実行されるマクロ
    * [Query_Refresh](bas\Query_Refresh.bas)
    * ショートカットキー`Ctrl`+`P`でも実行可能

#### 補足
* 初回実行時は遅い
    * .NET Frameworkやバックグラウンドクエリを実行しているらしい

# 参考
* [【Excelパワークエリ】複数のテーブルを結合する【テーブルもしくはブックからクエリを作成】- 大体でIT](https://daitaideit.com/excel-powerquery-join-multi-table/)
