# 宿題を管理するやーつ

## スペシャルサンクス
* クリエイターとして活躍してる友だちくん
  * 無断でアイデアをパクってしまったことを謝罪します
## 動作する環境
* Microsoft Excel
  * マクロ有効ブックが動作する環境
    * モバイル版やブラウザ版では動作しません

## 解説

#### 各セルの関数
基本的にマクロや関数などExcelの機能で設定するので触らない方がいい
##### I1
* 日付の設定
  ```
  =Today()
  ```
##### A3（課題ナンバー）
* テーブルのオートフィルにより自動入力
##### B3（表題）
* 対応セル `課題登録!C3`
##### C3（課題提示日）
* [カレンダーマクロ](#visual-basic-for-application-2)での補完可能
* 対応セル `課題登録!C4`
##### D3（納期）
* [カレンダーマクロ](#visual-basic-for-application-2)での補完可能
* 対応セル `課題登録!C5`
* 条件付き書式
  * 指定の値を含むセルの書式設定
    |ルール|塗りつぶしの色（FEX）|
    |:---:|:---:|
    |セルの値 > $I$1 | #FFC000 |
    |セルの値 = $I$1 | #92D050 |
    |セルの値 < $I$1 | #FFC7CE |
    * 設定例
      * ルール管理ウィンドウ
      ![D3-1](img/D3-1.png)
      * 編集ウィンドウ
      ![D3-2](img/D3-2.png)
##### E3（期日）
* 関数
  ```
  =IF(-($I$1-[@納期])<0,"受付終了",IF(-($I$1-[@納期])=0,"今日","あと"&-($I$1-[@納期])&"日"))
  ```
* 条件付き書式
  * 指定の値を含むセルの書式設定
    |ルール|塗りつぶしの色（FEX）|
    |:---:|:---:|
    |セルの値が'あと'で始まる | #FFC000 |
    |セルの値'今日'を含む  | #92D050 |
    |セルの値が'受付終了'を含む | #FFC7CE |
    * 設定例
        * ルール管理ウィンドウ 
        ![E3-1](img/E3-1.png)
        * 編集ウィンドウ
        ![E3-2](img/E3-2.png)
##### F3（命名規則）
* シート名を表示する
  * Power Queryを適用時に科目を識別するため
* 関数
  ```
  =RIGHT(CELL("filename",$A$1),LEN(CELL("filename",$A$1))-FIND("]",CELL("filename",$A$1)))
  ```
  * [【コピペOK】Excelでシート名を取得する方法の基本と応用－シート名を使った活用例 - ワカルニ](https://briarpatch.co.jp/wakaruni/excel-sheetname-acquisition/)
##### G3（進捗状況）
* 入力規則の設定
  * 設定方法は [#データの入力規則](#データの入力規則)を参考にする
  * 元の値
      ```
      未完成,完成
      ```
* 条件付き書式
  * 指定の値を含むセルの書式設定
    |ルール|塗りつぶしの色（FEX）|
    |:---:|:---:|
    |セルの値'完成'を含む  | #92D050 |
    |セルの値が'未完成'を含む | #FFC7CE |
##### H3（提出状況）
* 入力規則の設定
  * 設定方法は [#データの入力規則](#データの入力規則)を参考にする
  * 元の値
    ```
    未提出,提出済み
    ```
* 条件付き書式
  * 指定の値を含むセルの書式設定
    |ルール|塗りつぶしの色（FEX）|
    |:---:|:---:|
    |セルの値'提出済み'を含む  | #92D050 |
    |セルの値が'未提出'を含む | #FFC7CE |
##### I3（備考）
* 対応セル `課題登録!C4`

## 参考
* [ダウンロードとコピペで使えるExcelVBAのカレンダーコントロール - ateitexe](https://ateitexe.com/excel-vba-calendar-control2/)
* [【Excelパワークエリ】複数のテーブルを結合する【テーブルもしくはブックからクエリを作成】- 大体でIT](https://daitaideit.com/excel-powerquery-join-multi-table/)
* [【コピペOK】Excelでシート名を取得する方法の基本と応用－シート名を使った活用例 - ワカルニ](https://briarpatch.co.jp/wakaruni/excel-sheetname-acquisition/)
* [tatzyr/image.md - github gist](https://gist.github.com/Tatzyr/3847141)
* [[Excel で VBA] For 文の続き／While 文による繰り返し](https://brain.cc.kogakuin.ac.jp/~kanamaru/lecture/vba2013/04-for02.html)
* [【VBA】テーブル名を取得する方法【ListObjectsを使う】- 大体でIT](https://daitaideit.com/vba-table-get-table-name/#mokuzi1-2)
* [【VBA入門】シートのコピーと移動(複数コピーや名前の変更も解説) - SAMURAIENGINEER](https://www.sejuku.net/blog/29120)
  
## 更新歴
### v1.0
* 2023-05-22
* 初期版
### v1.1
* 2023-05-22
* 書式設定の見直し
### v2.0
* 2023-06-23
* Power Query追加
### v2.1
* 2023-06-25
* 課題登録フォーム追加
* 授業の追加を自動化
